pipeline { //pipeline

    agent any
    options { disableConcurrentBuilds() }

    tools {
        terraform 'terraformtool'
    }

    stages ('Setup Roboshop Application') { //stages
        stage ('Installing Frontend Server') { //Frontend stage
            steps { //Frontend steps
            withCredentials([aws(accessKeyVariable: 'AWS_ACCESS_KEY_ID', credentialsId: 'awskey', secretKeyVariable: 'AWS_SECRET_ACCESS_KEY')]) {
                    git 'https://github.com/imjitthu/tfas-frontend.git'
                    tool name: 'terraformtool', type: 'terraform' terraform init
                    //sh "terraform apply -auto-approve"
                    } //with credentials
            ansiblePlaybook credentialsId: 'DevOps321', installation: 'ansibletool', inventory: 'frontend_inv', playbook: 'frontend.yml'
                } //Frontend steps
            } //Frontend stage
        } //stages
    } //pipeline